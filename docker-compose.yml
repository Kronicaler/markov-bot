version: '1.2.0'

services:
  jaeger:
    image: jaegertracing/all-in-one:1.49
    restart: unless-stopped
    ports:
      - 16686:16686

  mariadb:
    image: mariadb
    restart: unless-stopped
    environment:
      MARIADB_ROOT_PASSWORD: ${DB_PASS}
      MARIADB_DATABASE: markov_bot
    deploy:
      resources:
        limits:
          memory: 500M
    ports:
      - 3306

  markov_bot:
    image: kronicaler/markov_bot
    container_name: markov_bot
    environment:
      - DISCORD_TOKEN
      - APPLICATION_ID
      - DATABASE_URL=mysql://root:${DB_PASS}@mariadb/markov_bot
    build:
      context: ./
      dockerfile: dockerfile
    restart: unless-stopped
    volumes:
      - markovbot:/app/data

volumes:
  markovbot: